function Kuzzle(t){return t&&""!==t?this instanceof Kuzzle?(this.socket=io(t),this.subscribe=function(t,e,i){var n=Math.uuid();return this.socket.once(n,function(t){this.socket.off(t.result),this.socket.on(t.result,function(t){i(t)})}.bind(this)),this.socket.emit("subscribe",{requestId:n,action:"on",collection:t,body:e}),n},this.unsubscribe=function(t){this.socket.emit("subscribe",{requestId:t,action:"off"})},this.write=function(t,e,i,n,o){var c=Math.uuid();o&&this.socket.once(c,function(t){o(t)}),void 0===n&&(n=!1),this.socket.emit("write",{requestId:c,action:e,persist:n,collection:t,body:i})},this.create=function(t,e,i,n){this.write(t,"create",e,i,n)},this.update=function(t,e,i){this.write(t,"update",e,!0,i)},this["delete"]=function(t,e,i){var n={_id:e};this.write(t,"delete",n,!0,i)},this.deleteByQuery=function(t,e,i){this.write(t,"deleteByQuery",e,!0,i)},this.search=function(t,e,i){var n=Math.uuid();this.socket.once(n,function(t){i(t)}),this.socket.emit("read",{requestId:n,action:"search",collection:t,body:e})},this.get=function(t,e,i){var n=Math.uuid();this.socket.once(n,function(t){i(t)}),this.socket.emit("read",{requestId:n,action:"get",collection:t,_id:e})},void(this.count=function(t,e,i){var n=Math.uuid();this.socket.once(n,function(t){i(t)}),this.socket.emit("read",{requestId:n,action:"count",collection:t})})):new Kuzzle(t):(console.error("Url to Kuzzle can't be empty"),!1)}!function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(e,i){var n,o=t,c=[];if(i=i||o.length,e)for(n=0;e>n;n++)c[n]=o[0|Math.random()*i];else{var s;for(c[8]=c[13]=c[18]=c[23]="-",c[14]="4",n=0;36>n;n++)c[n]||(s=0|16*Math.random(),c[n]=o[19==n?3&s|8:s])}return c.join("")},Math.uuidFast=function(){for(var e,i=t,n=new Array(36),o=0,c=0;36>c;c++)8==c||13==c||18==c||23==c?n[c]="-":14==c?n[c]="4":(2>=o&&(o=33554432+16777216*Math.random()|0),e=15&o,o>>=4,n[c]=i[19==c?3&e|8:e]);return n.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})}}();